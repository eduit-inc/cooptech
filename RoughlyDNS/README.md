# ざっくり解説DNS

## DNSの役割

Domain Name System

## レコード解説

### A(Address)レコード

IPアドレスを保持するレコード

ほとんどのWebサイトにはAレコードが1つしかないが、複数のAレコードを持つことも可能。

一部のサイトでは「ラウンドロビン負荷分散」が利用されており、 複数のWebサーバをレスポンスとして返している。

#### 例

|example.com|record type|value|TTL|
|---|---|---|---|
|@|A|192.0.2.1|14400|

**@** はルートドメインのレコードであることを示している。

TTL秒単位で記載したもの。
AレコードのデフォルトのTTLは14,400秒なので、このレコードが更新された跡、反映されるまでに240分かかる。



### AAAAレコード

IPv6アドレスを保有するレコード

### CNAME(Canonical Name)レコード

IPアドレスは取り扱わず、ドメインまたはサブドメインを別のドメインに転送するレコード

### MXレコード

メールサーバーにメールを送信するレコード

### TXTレコード

テキストメモを登録するレコード。用途は多岐にわたる。

その多くはセキュリティ確保や所有権確保に利用される。
電子メールのセキュリティを高めるために利用されたりドメインの所有権を確認する。

### SPFレコード

TXTに付随して使われるレコードで、ドメインが迷惑メールとして利用されないようにするためのレコード

### NS(Name Server)レコード

DNSの主なレコード。DNSのネームサーバを格納する。

適切にこのレコードを設定しないとWebサイトやアプリケーションを読み込めない。

基本的にNSレコードは、どこに行けばドメインのIPアドレスを見つけられるかを知らせるもの。

NSレコードはどのDNSサーバがそのドメインの権威サーバ（実際にDNSレコードがあるか）を示す。

また、ドメインには多くの場合複数のNSレコードがあり、
プライマリネームサーバとセカンダリネームサーバも指します。

#### ネームサーバとは？

ネームサーバはDNSサーバの一種。ドメインに関するDNSレコード
(Aレコード、MXレコード、CNAMEレコード)をすべて保存するサーバ。

ほぼすべてのドメインが複数のネームサーバを利用して信頼性・可用性を高める。

そのためのプライマリ・セカンダリのネームサーバ。

1つのネームサーバが停止・利用不可となった場合に、DNSリクエストを他のネームサーバに転送できる。

通常、プライマリネームサーバが1つ、セカンダリネームサーバが複数あり、
プライマリサーバにDNSレコードの複製が保存される。その後、セカンダリネームサーバにも更新される。

### SOAレコード

ドメインに関する管理情報を格納する。

### SRVレコード

特定のサービスポートを指定する

### PTRレコード

リバースルックアップ（逆引き）でドメイン名を提供する。

### ALIASレコード

AWSのRoute53で提供されているレコード。

Amplifyなど、特定のサービスと紐づけることができる。

### 参考

[引用元](https://www.cloudflare.com/ja-jp/learning/dns/dns-records/)

## セキュリティ

### DNSキャッシュポイズニング

偽のDNS応答をキャッシュDNSサーバにキャッシュさせることで、偽のサイトのIPアドレスを返却する。

- GoogleのIPアドレス: **142.250.207.46**
- 毎回問い合わせても面倒なので、キャッシュ用のDNSサーバに **142.250.207.46** をキャッシュさせる。
- このキャッシュ用DNSサーバに攻撃を仕掛けて **google.com** に対して **183.79.248.124** を返却するように罠を仕掛ける
- 再度 **google.com** にアクセスすると、本来**142.250.207.46**なのに、キャッシュからは**183.79.248.124**が返却され、Yahooが見える。

Yahooだから良いものの、ダミー用のGoogleサイトで、個人情報が抜かれることも、、、
